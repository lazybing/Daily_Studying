## 摘要

码率控制是 CBR 编码中的一项重要技术。AVC 标准包含几种帧间和帧内预测模式。现有的 AVC 软件很难采用现有的码率控制技术，因为基于先决量化参数的率失真优化(RDO)决定每个宏块的最优预测。针对 AVC 标准，本文提出了一种基于自适应量化参数的宏块级码率控制算法。实验结果表明，本位提出的码率控制算法能够准确地实现目标码率。尽管视频序列的目标质量 PSNR 略有下降，编码效率与固定量化参数视频编码相当或优于固定量化参数视频编码。

## 引言

码率控制在 CBR 视频编码中起着非常重要的作用，尽管它不是所有视频编码标准的规范工具。然而，如果没有码率控制，许多视频方案在许多应用中都是无用的。因为当压缩刘传送信道保持恒定带宽时，客户端缓冲区可能经常发生上溢或下溢。因此，每个视频编码标准都有自己的码率控制技术，例如 MPEG-2 的 TM5 和 H.263 的 TMN8。

AVC标准是由 ISO 和 ITU-T 联合视频团队(JVT)联合开发的（在H.26x 系列标准中也称为 MPEG-4 第 10 部分和 H.264），它通过利用各种时间和空间预测技术，已经显著地优于先前的视频编码标准。最优预测由 RDO 基于先决量化参数确定。但是， AVC 标准很难采用现有的速率控制技术。

率失真理论是视频编码的基础理论。率和失真之间的关系是一个不等式函数，如图 1 所示。在给定码率约束下，RDO 使解码失真最小。拉格朗日方法能有效地解决这一问题，已在 H.263+ 的 TMN10 中得到应用。在 AVC 中，运动补偿和帧内预测采用拉格朗日方法进行模式选择。也就是说，在给定的码率约束条件下，该算法可以使失真最小化，并找到块的最优运动矢量和编码方式。

然而，在 AVC 中使用拉格朗日方法使得码率控制成为一项困难的任务，因为码率和失真的计算涉及到量化参数。对于不同的量化参数，可以选择不同的运动矢量和编码模式。因此，块的速率和失真与码率控制决定的量化参数相关联。换句话说，在调整量化参数之后，码率控制方案将影响块的运动矢量和模式选择。

由于编码效率高，AVC 是一种很有钱途的视频编码标准。然而，不同于现有的视频编码标准，AVC 标准中的码率控制由于涉及量化参数，很难应用于宏块级的码率控制和 RDO。综合考虑码率控制和 RDO 的基础上，提出了一种适用于 AVC 标准的宏块级码率控制算法。我们的重点是通过使用宏块层来解决上述问题，进而提高具有高运动或场景变化的帧的质量。

本文结构如下：第 2 节回顾了现有的速率控制算法；第 3 节提出了解决现有速率控制问题的策略；第 4 节给出了实验结果；最后，第 5 节对本文进行了总结，并对今后的工作提出了建议。

## 相关工作

## 提出算法

在预测性差的图像序列中，场景变化、缩放和快速运动可能由于与前一图片的相关性小而发生图像质量下降。本文提出了一种简单的方法，通过改变前一帧和当前帧之间的相关性来提高 H.264 编解码器的性能。

本文提出了五个步骤：1. 缓冲区占用初始化；2. 确定目标缓冲区占用率；3. 目标比特流的计算；4. 确定当前帧的宏块的量化参数；5. 率失真优化。步骤 2 和步骤 3 与 [14] 相同。


